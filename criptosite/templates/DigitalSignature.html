{% extends "base_template.html" %}

{% load static %}

{% block head_content %}
<title>CriptoBros - Digital Signature</title>
{% endblock %}

{% block main %}

<!-- Begin Page Content -->
<div class="container-fluid">

    <!-- Page Heading -->
    <h1 class="h3 mb-2 text-gray-800">Digital signature Authenticator</h1>
    <p class="mb-4">The Elliptic Curve Digital Signature Algorithm (ECDSA) is a Digital Signature Algorithm (DSA) which uses keys derived from elliptic curve cryptography (ECC). It is a particularly efficient equation based on public key cryptography (PKC). ECDSA is used across many security systems, is popular for use in secure messaging apps, and it is the basis of Bitcoin security (with Bitcoin "addresses" serving as public keys).</p>

    <!-- Content Row -->
    <div class="row">

        <div class="col-xl-7 col-lg-7">

            <!-- Encrypt Chart -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Encrypt</h6>
                </div>
                <div class="card-body">
                    <form method="POST" action="" target="_self">
                        {% csrf_token %} 
                        <div class="chart-area">
                            <textarea name='input_text' class="form-control" rows="11" required>{{ clear_text }}</textarea>
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                              <span class="input-group-text" id="inputGroup-sizing-default">Private Key</span>
                            </div>
                            <input type="text" name='in_priv_key' class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default">
                        </div>
                        <input name="encrypt" class="btn btn-primary btn-block" type="submit" value="Submit">
                    </form>
                </div>
            </div>
        </div>

        <div class="col-xl-4 d-flex align-items-stretch">
            <!-- Outputs Chart -->
            <div class="card shadow mb-4">
                <!-- Card Header - Dropdown -->
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Encryption Keys</h6>
                </div>
                <!-- Card Body -->
                <div class="card-body">
                    <div class="chart-area">
                        <form method="POST" action="" target="_self">
                            {% csrf_token %}
                            <div class="form-group">
                                <label class="control-label col-sm-2  font-weight-bold" for="exampleFormControlTextarea1">Verification Key</label>
                                <textarea type="text" name='public_key' class="form-control" rows="5" cols="80">{{ ver_key }}</textarea>
                            </div>
                            <div class="form-group">
                                <label class="control-label col-sm-2  font-weight-bold" for="exampleFormControlTextarea1">Private Key</label>
                                <textarea type="text" name='private_key' class="form-control" rows="5" cols="80">{{ priv_key }}</textarea>
                            </div>
                            <input name="generate" class="btn btn-primary btn-block" type="submit" value="Generate Encryption Keys">
                        </form>
                    </div>        
                </div>
            </div>
        </div>

        <div class="w-100"></div>

        <div class="col-xl-7 col-lg-7">

            <!-- Decrypt Chart -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-1 font-weight-bold text-primary">Authenticate</h6>
                </div>
                <div class="card-body">
                    <form method="POST" action="", target="_self">
                        {% csrf_token %} 
                        <div class="chart-area">
                            <textarea name='ciphered_text' class="form-control" rows="11" required>{{ cipher }}</textarea>
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                              <span class="input-group-text" id="inputGroup-sizing-default">Verification Key</span>
                            </div>
                            <input type="text" name='in_pub_key' class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default">
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                              <span class="input-group-text" id="inputGroup-sizing-default">Original Text</span>
                            </div>
                            <input type="text" name='in_text' class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default">
                        </div>
                        <input name="decrypt" class="btn btn-primary btn-block" type="submit" value="Submit">
                    </form>
                </div>
            </div>

        </div>

        <div class="col-xl-4 d-flex align-items-stretch">
            <!-- Outputs Chart -->
            <div class="card shadow mb-4">
                <!-- Card Header - Dropdown -->
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Outputs</h6>
                </div>
                <!-- Card Body -->
                <div class="card-body">
                    <div class="chart-area">
                        <textarea class="form-control" rows="15" cols="80">{{ result }}</textarea>
                    </div>        
                </div>
            </div>
        </div>

        
        
    </div>


</div>
<!-- /.container-fluid -->
{% endblock %}
<!-- </body> -->